<!DOCTYPE html>
<html lang="pt-PT">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Listagem de Encomendas de Componentes</title>

  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
  {% include '$navbar.html' %}

  <div class="p-12">
    <div class="flex items-center mb-8 justify-between h-fit">
      <h1 class="text-4xl">Listagem de Encomendas de Componentes</h1>

      <a href="register" class="bg-gray-900 px-16 py-2 border border-gray-500 rounded-3xl text-white w-fit">Encomendar</a>
    </div>

    <div class="mb-2">
      <form method="POST" action="/components/orders/ ">
        {% csrf_token %}

        <label class="mr-2"><b>Procurar por:</b></label>
        <input type="text" name="filter_name" id="filter_name" placeholder="Nome" value="{{ request.POST.filter_name }}" class="border border-gray-500 rounded p-2">

        <button type="submit" class="bg-gray-900 py-2 px-4 text-white rounded">Pesquisar</button>

        <select name="sort_order" id="sort_order" class="appearance-none border border-gray-500 rounded-3xl w-md p-2 leading-tight focus:outline-none focus:shadow-outline ml-2">
          <option value="id-asc">ID (Asc)</option>
          <option value="id-desc">ID (Desc)</option>
          <option value="date-asc">Data (Asc)</option>
          <option value="date-desc">Data (Desc)</option>
          <option value="components-asc">Componentes (Asc)</option>
          <option value="components-desc">Componentes (Desc)</option>
          <option value="supplier-asc">Fornecedor (Asc)</option>
          <option value="supplier-desc">Fornecedor (Desc)</option>
          <option value="employee-asc"> Funcionário (Asc)</option>
          <option value="employee-desc"> Funcionário (Desc)</option>
        </select>

        <script>
          if ("{{ request.POST.sort_order }}" !== "") {
            document.getElementById('sort_order').value = "{{ request.POST.sort_order }}";
          }
        </script>
      </form>
    </div>
    <div class="flex flex-col gap-4 mt-4">
      <table class="overflow-auto border border-gray-300 h-full w-full table-fixed border-collapse border-spacing-px text-left">
        <thead>
          <tr>
            <th class="border border-gray-300 bg-gray-200 text-black p-1 w-12">ID</th>
            <th class="border border-gray-300 bg-gray-200 text-black p-1">Data</th>
            <th class="border border-gray-300 bg-gray-200 text-black p-1">Componentes</th>
            <th class="border border-gray-300 bg-gray-200 text-black p-1">Fornecedor</th>
            <th class="border border-gray-300 bg-gray-200 text-black p-1">Exportado</th>
            <th class="border border-gray-300 bg-gray-200 text-black p-1">Funcionário</th>
            <th class="border border-gray-300 bg-gray-200 text-black p-1 w-32">Ações</th>
          </tr>
        </thead>
        <tbody>
          {% for component_order in component_orders %}
          <tr>
            <td class="border border-gray-300 text-black p-1">{{component_order.0}}</td>
            <td class="border border-gray-300 text-black p-1">{{component_order.1}}</td>
            <td class="border border-gray-300 text-black p-1">
              {% for component in component_order.5 %}
              {{ component.2 }}x {{ component.1 }}
              {% if not forloop.last %}, {% endif %}
              {% endfor %}
            </td>
            <td class="border border-gray-300 text-black p-1">{{component_order.2}}</td>
            <td class="border border-gray-300 text-black p-1">
              {% if component_order.4 %}
              Sim
              {% else %}
              Não
              {% endif %}
            </td>
            <td class="border border-gray-300 text-black p-1">
              {{component_order.3}}
            </td>

            <td class="border border-gray-300 text-black p-1">
              <a href="edit/{{component_order.0}}" class="underline">
                Editar
              </a>
              <br>
              <a href="delete/{{component_order.0}}" class="underline text-red-500">
                Apagar
              </a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <div class="flex mt-8 gap-4">
        <!--{% include '$submit.html' with text="Exportar XML" id="exportXMLButton" %}-->
        <button class="bg-gray-900 px-16 py-2 border border-gray-500 rounded-3xl text-white w-fit" type="button">
          <a href="export-xml/">
            Exportar XML
          </a>
        </button>
        <!--{% include '$submit.html' with text="Exportar JSON" %}-->
        <button class="bg-gray-900 px-16 py-2 border border-gray-500 rounded-3xl text-white w-fit" type="button">
          <a href="export-json/">
            Exportar JSON
          </a>
        </button>
      </div>
    </div>
  </div>
</body>

</html>
